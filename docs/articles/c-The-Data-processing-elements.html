<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Data processing elements • harmonizR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The Data processing elements">
<meta property="og:description" content="harmonizR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">harmonizR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.0.1003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-Glossary-and-templates.html">Glossary and templates</a>
    </li>
    <li>
      <a href="../articles/b-Understand-the-workflow.html">Understand the workflow</a>
    </li>
    <li>
      <a href="../articles/c-The-Data-processing-elements.html">The Data processing elements</a>
    </li>
    <li>
      <a href="../articles/d-Example-with-DEMO-files.html">Example with DEMO files</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/maelstrom-research/harmonizR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="c-The-Data-processing-elements_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="c-The-Data-processing-elements_files/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="c-The-Data-processing-elements_files/datatables-binding-0.28/datatables.js"></script><link href="c-The-Data-processing-elements_files/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="c-The-Data-processing-elements_files/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="c-The-Data-processing-elements_files/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><script src="c-The-Data-processing-elements_files/jszip-1.13.4/jszip.min.js"></script><link href="c-The-Data-processing-elements_files/dt-ext-buttons-1.13.4/css/buttons.dataTables.min.css" rel="stylesheet">
<script src="c-The-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/dataTables.buttons.min.js"></script><script src="c-The-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/buttons.html5.min.js"></script><script src="c-The-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/buttons.colVis.min.js"></script><script src="c-The-Data-processing-elements_files/dt-ext-buttons-1.13.4/js/buttons.print.min.js"></script><link href="c-The-Data-processing-elements_files/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="c-The-Data-processing-elements_files/crosstalk-1.2.0/js/crosstalk.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The Data processing elements</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/maelstrom-research/harmonizR/blob/HEAD/vignettes/c-The-Data-processing-elements.Rmd" class="external-link"><code>vignettes/c-The-Data-processing-elements.Rmd</code></a></small>
      <div class="hidden name"><code>c-The-Data-processing-elements.Rmd</code></div>

    </div>

    
    
<style>
    .flex-container {
        display: flex;
        align-items: flex-start;
    }
    .image-container-big {
        flex: 70%;
        padding-right: 30px;
    }
    .image-container-even {
        flex: 50%;
        padding-right: 20px;
    }
    .text-container-small {
        flex: 30%;
        display: flex;
        flex-direction: column;
        justify-content: flex-start;
    }
</style>
<div class="section level2">
<h2 id="what-is-the-data-processing-elements">What is the Data Processing Elements ?<a class="anchor" aria-label="anchor" href="#what-is-the-data-processing-elements"></a>
</h2>
<p>The Data Processing Element (DPE) is a table that gathers all the
harmonization rules used to create each variable defined in the
dataSchema. This table is typically an Excel spreadsheet where each row
indicates how the study-specific variables are processed to generate a
harmonized variable. Once this table is filled, it is used in the <a href="../reference/harmo_process.html">harmo_process()</a> function
along with the other two parameters (data_schema and dossier) to create
the harmonized_dossier. If harmonization cannot be performed correctly
due to errors in the DPE, the harmonized_dossier generated can be sent
to the <a href="../reference/show_harmo_error.html">show_harmo_error()</a>
function, allowing the user to correct the DPE and restart the
process.</p>
<div class="section level3">
<h3 id="cheat-sheet">Cheat Sheet :<a class="anchor" aria-label="anchor" href="#cheat-sheet"></a>
</h3>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4327f3bd096c6b0db436" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-4327f3bd096c6b0db436">{"x":{"filter":"none","vertical":false,"extensions":["Buttons"],"data":[["<code> variable_ID <\/code>","<code> variable_A <\/code>","<code> variable_B <\/code>","<code> variable_C <\/code>","<code> variable_E <\/code>","<code> variable_D <\/code>","<code> variable_F <\/code>","<code> variable_G <\/code>","<code> variable_H <\/code>"],["<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>"],["<code> col_id <\/code>","<code> var_x <\/code>","<code> var_y <\/code>","<code> var_x ; var_z <\/code>","<code> var_x <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>id_creation<\/b><em style=\"color:red\"> (mandatory)<\/em> <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>recode<\/b> <\/code>","<code> <b>case_when<\/b> <\/code>","<code> <b>operation<\/b> <\/code>","<code> <b>paste<\/b> <\/code>","<code> <b>other<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>id_creation<\/b> <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>recode(<\/b>           \n  \"YES\" = 1 ;         \n  \"NO\"  = 0 ;   \n  ELSE  = NA<b>) <\/b> <\/code>","<code> <b>case_when(<\/b>      \n  var_x == 1 ~ var_z ;\n  ELSE       ~ NA<b>)<\/b> <\/code>","<code> var_x - mean(var_x) / stats::sd(var_x) <\/code>","<code> Hello word <\/code>","<code> # place R code here... <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>complete<\/b> <\/code>","<code> <b>complete<\/b> <\/code>","<code> <b>complete<\/b> <\/code>","<code> <b>complete<\/b> <\/code>","<code> <b>complete<\/b> <\/code>","<code> <b>complete<\/b> <\/code>","<code> <b>complete<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th><b>dataschema_variable<\/b><\/th>\n      <th><b>ss_table<\/b><\/th>\n      <th><b>ss_variables<\/b><\/th>\n      <th><b>Mlstr::rule_category<\/b><\/th>\n      <th><b>Mlstr::algorithm<\/b><\/th>\n      <th><b>Mlstr::status<\/em><\/b><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"searching":false,"paging":false,"info":false,"scrollX":false,"ordering":false,"pageLength":9,"dom":"Bfrtip","buttons":["copy","csv","excel"],"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[9,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level4">
<h4 id="summary">General structure of the DPE<a class="anchor" aria-label="anchor" href="#summary"></a>
</h4>
<p><a href="#dsc-tbl-var">dataschema_variable, ss_table and
ss_variables</a></p>
<p><a href="#status">Mlstr_harmo::status and
Mlstr_harmo::status_detail</a></p>
<p><a href="#rules">Mlstr_harmo::rule_category and
Mlstr_harmo::algorithm</a></p>
</div>
<div class="section level4">
<h4 id="harmonization-rules">Harmonization rules<a class="anchor" aria-label="anchor" href="#harmonization-rules"></a>
</h4>
<p><a href="#id-creation">id_creation</a></p>
<p><a href="#direct-mapping">direct_mapping</a></p>
<p><a href="#recode">recode</a></p>
<p><a href="#case-when">case_when</a></p>
<p><a href="#paste">paste</a></p>
<p><a href="#operation">operation</a></p>
<p><a href="#other">other</a></p>
<p><a href="#impundebla">impossible, undertermined and __BLANK__</a></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="general-structure-of-the-dpe">General structure of the DPE<a class="anchor" aria-label="anchor" href="#general-structure-of-the-dpe"></a>
</h2>
<p>The DPE is an typically an Excel file that you open locally in your
computer and that you can fill one row after the other to generate the
rules of harmonization. It contains at least 5 mandatory columns, plus
one additional for your documentation. The process cannot work if one of
these columns are not present.</p>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-65462a377463bb55977b" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-65462a377463bb55977b">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<code><b>dataschema_variable<\/b><\/code>","<code><b>ss_table<\/b><\/code>","<code><b>ss_variables<\/b><\/code>","<code><b>Mlstr::rule_category<\/b><\/code>","<code><b>Mlstr::algorithm<\/b><\/code>","<code><b>Mlstr::status<\/b><\/code>"],["Variable defined in the dataSchema","Study specific table where the <br>\n                                                 study specific variable is taken from","Study specific variable (name of the column in the dataset)","Rule category","Algorithm associated to the rule category","Harmonization status.if the column<br>\n                                                 is not provided or empty, it will<br>\n                                                 be automatically generated during <br>\n                                                 the process, and any empty cell<br>\n                                                 will be filled with <code>complete<\/code><br>\n                                                 or <code>impossible<\/code> accordingly"],["<b>YES<\/b>","<b>YES<\/b>","<b>YES<\/b>","<b>YES<\/b>","<b>YES<\/b>","NO"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>column name<\/th>\n      <th>definition<\/th>\n      <th>mandatory<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"ordering":false,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="dsc-tbl-var">dataschema_variable, ss_table and ss_variables<a class="anchor" aria-label="anchor" href="#dsc-tbl-var"></a>
</h3>
<p>For each dataSchema variable and each study specific dataset, the
user must provide which variable(s) will be transformed to generate the
harmonized variable.</p>
<ul>
<li><p>The name of each study specific dataset must be exactly the same
(case sensitive) in the study specific dataset dossier (the dossier
provided as input in the function <a href="../reference/harmo_process.html">harmo_process()</a>).</p></li>
<li><p>The name(s) of the variable(s) must be exactly the same (case
sensitive) in the dataset where the variable name is taken from. Plus,
the variable(s) must exist in the dataset to be used in the
process.</p></li>
<li><p>If no variable is needed to generate the harmonized variable (for
example using the rule category <strong>paste</strong> or
<strong>other</strong>), the user must provide
<strong>_<strong>BLANK</strong>_</strong> as a placeholder. This ensure
that the line is completed and there is no missing argument in the
function to perform.</p></li>
<li><p>If more than one variable is used to generate the harmonized
variable, they must me separated by semi colon
<strong>;</strong></p></li>
<li><p>The first rule category for each study-specific dataset
<strong>must</strong> be <strong>d_creation</strong></p></li>
</ul>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ca3c82ae9a2480504577" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-ca3c82ae9a2480504577">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<code>1<\/code>","<code>2<\/code>","<code>3<\/code>","<code>1<\/code>","<code>2<\/code>","<code>3<\/code>"],["<code> <b>variable_ID<\/b> <\/code>","<code> variable_A <\/code>","<code> variable_B <\/code>","<code> <b>variable_ID<\/b> <\/code>","<code> variable_A <\/code>","<code> variable_B <\/code>"],["<code> dataset_MELBOURNE <\/code>","<code> dataset_MELBOURNE <\/code>","<code> dataset_MELBOURNE <\/code>","<code> dataset_PARIS <\/code>","<code> dataset_PARIS <\/code>","<code> dataset_PARIS <\/code>"],["<code> col_id <\/code>","<code> var_x <\/code>","<code> var_y <\/code>","<code> ID_part <\/code>","<code> var_x <\/code>","<code> <b>impossible<\/b> <\/code>"],["<code><b>id_creation<\/b><\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>recode<\/b> <\/code>","<code><b>id_creation<\/b><\/code>","<code> <b>operation<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>"],["<code> <b>id_creation<\/b> <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>recode(<\/b>           \n  \"YES\" = 1 ;         \n  \"NO\"  = 0 ;   \n  ELSE  = NA<b>) <\/b> <\/code>","<code> <b>id_creation<\/b> <\/code>","<code> var_x - mean(var_x) / stats::sd(var_x) <\/code>","<code> <b>impossible<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th><b>index<\/b><\/th>\n      <th><b>dataschema_variable<\/b><\/th>\n      <th><b>ss_table<\/b><\/th>\n      <th><b>ss_variables<\/b><\/th>\n      <th><b>Mlstr::rule_category<\/b><\/th>\n      <th><b>Mlstr::algorithm<\/b><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"ordering":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<blockquote>
<p>Useful tip : You can add an index for each of your harmonised
variables and work either per dataset or per harmonized variables using
filter/order in Excel.</p>
</blockquote>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="rules">Mlstr_harmo::rule_category and Mlstr_harmo::algorithm<a class="anchor" aria-label="anchor" href="#rules"></a>
</h3>
<p>These columns are the core center of the harmonization process. The
user has access to 5 rules of harmonization to transform, process or
combine study-specific variables to generate harmonized variables. In
addition, they have the ability to generate their own rule using the
function ‘other’. If in a dataset, no variable corresponds to the
definition of the harmonized variable, the user can put ‘impossible’ to
generate NAs and if the user needs more information decide how to
harmonize a variable, they can use the placeholder ‘undermined’.</p>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="id-creation">id_creation (mandatory)<a class="anchor" aria-label="anchor" href="#id-creation"></a>
</h3>
<p>This rule allows the process to initiate. This is a very important
step, because the user provides the column which will be used as a
reference per observation (row)</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ea8767a67349d954f19a" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-ea8767a67349d954f19a">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_ID <\/code>","<code> DATASET <\/code>","<code> col_id <\/code>","<code><b>id_creation<\/b><\/code>","<code> <b>id_creation<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li><p>This step is mandatory and must be the first rule for each
dataset.</p></li>
<li><p>Usually, the harmonized variable is a standardized identifier
generated from the study-specific identifier.</p></li>
<li><p>If the dataset does not have any identifier column, the user can
create <em>before harmonization</em> an index and provide this index as
the variable to use.</p></li>
</ul>
</div>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="direct-mapping">direct_mapping<a class="anchor" aria-label="anchor" href="#direct-mapping"></a>
</h3>
<p>The harmonized variable is generated by replicating one
study-specific variable.</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-d0bdde4548ce3801e703" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-d0bdde4548ce3801e703">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_A <\/code>","<code> DATASET <\/code>","<code> var_x <\/code>","<code> <b>direct_mapping<\/b> <\/code>","<code> <b>direct_mapping<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li>One and only one variable can be replicated at a time.</li>
</ul>
</div>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="recode">recode<a class="anchor" aria-label="anchor" href="#recode"></a>
</h3>
<p>The harmonized variable is generated by recoding values from one
study-specific variable.</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fb02675410ceafdec521" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-fb02675410ceafdec521">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_B <\/code>","<code> DATASET <\/code>","<code> var_y <\/code>","<code> <b>recode<\/b> <\/code>","<code> <b>recode(<\/b>           \n  \"YES\" = 1 ;         \n  \"NO\"  = 0 ;   \n  ELSE  = NA<b>) <\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li><p>One and only one variable can be recoded at a time.</p></li>
<li><p>The variable to be recoded must be (partially at the very least)
a categorical variable. To recode a continuous variable (to create
brackets for example.), use <strong>case_when</strong> instead.</p></li>
<li><p>If all categories are recoded to the same categories (recode(1 =
1 ; 2 = 2)), Prefer <strong>direct_mapping</strong> instead.</p></li>
<li><p>Separate each value/code with an equal sign
<strong>=</strong></p></li>
<li><p>Separate each elements with a semi-colon <strong>;</strong>
.</p></li>
<li><p>Use <strong>ELSE = NA</strong> to attribute NA to all of the
other values.</p></li>
</ul>
</div>
</div>
<div>
<p>If an equal sign already exists in the data, use <strong>_=</strong>
to escape them. Equally, if a semi-colon already exists in the data, use
<strong>_;</strong> to escape them.</p>
<pre><code>recode(
   "banana ; apple"  = "fruits"    _;
   "salad  ; potatoe" = "veggies"  _;
   "bread  ; pasta"   = "carbs"        )

recode(
   "1000 (='high')  _= 3  ;
   " 500 (='mid')   _= 2  ;
   " 200 (='low')   _= 1     )
</code></pre>
<p>The values can be gathered using R synthax to recode multiple
numerical values.</p>
<pre><code>recode(
   0            = "low"   ;
   c(1:10)      = "mid"   ;
   c(-7, -99)   = NA    )
</code></pre>
</div>
<p>If the recoding requires more complex codification, use
<strong>case_when</strong> or <strong>other</strong> instead.</p>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="case-when">case_when<a class="anchor" aria-label="anchor" href="#case-when"></a>
</h3>
<p>The harmonized variable is generated from one or more if-else
conditions, using one or more study-specific variables.</p>
<p>The harmonized variable is generated by recoding values from one
study-specific variable.</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-08f876d6b2aaf5ad846f" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-08f876d6b2aaf5ad846f">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_C <\/code>","<code> DATASET <\/code>","<code> var_x ; var_z <\/code>","<code> <b>case_when<\/b> <\/code>","<code> <b>case_when(<\/b>      \n  var_x == 1 ~ var_z ;\n  ELSE       ~ NA<b>)<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li><p>Multiple variables can be used to combine their values using
case_when. Separate each of them in <strong>ss_variables</strong> by a
semi-colon <strong>;</strong></p></li>
<li><p>If only one variable is used, and is (or seems) a categorical
variable, use <strong>recode</strong> or <strong>direct_mapping</strong>
instead.</p></li>
<li><p>Each statement (“if … equals, greater, is not, …”) can be use in
this function. Separate the statement/code with a tilde
<strong>~</strong></p></li>
<li><p>Separate each elements with a semi-colon <strong>;</strong>
.</p></li>
<li><p>Use <strong>ELSE ~ NA</strong> to attribute NA to all of the
other values.</p></li>
</ul>
</div>
</div>
<div>
<p><strong>case_when</strong> is sentitive to the data type. Each code
generated with the statement must have the same data type, including the
NA.</p>
<pre><code>case_when(
   var_x == 1                 ~ 1  
   var_x != 0 &amp; !is.na(var_y) ~ 0  
   ELSE                       ~ NA_real_     )

case_when(
   var_x == 1                 ~ 1L  
   var_x != 0 &amp; !is.na(var_y) ~ 0L  
   ELSE                       ~ NA_integer_  )
   
case_when(
   var_x == 1                 ~ "1"  
   var_x != 0 &amp; !is.na(var_y) ~ "0"  
   ELSE                       ~ NA_character_)
   
case_when(
   var_x == 1                 ~ TRUE  
   var_x != 0 &amp; !is.na(var_y) ~ FALSE  
   ELSE                       ~ NA           ) 
</code></pre>
<p>If the statement requires more complex codification, use
<strong>other</strong> instead.</p>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="paste">paste<a class="anchor" aria-label="anchor" href="#paste"></a>
</h3>
<p>The harmonized variable is generated by setting the same value for
all observation, not taken from a study-specific variable.</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-fbde03fba7b1b093c3df" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-fbde03fba7b1b093c3df">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_D <\/code>","<code> DATASET <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>paste<\/b> <\/code>","<code> Hello word <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li><p>This function does not require any variable. The user must
provide <strong>_<strong>BLANK</strong>_</strong> as a
placeholder.</p></li>
<li><p>Usually, the harmonized variable is a standardized identifier for
the whole study when comes the time to aggregate the harmonized datasets
into a pooled harmonized dataset.</p></li>
</ul>
</div>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="operation">operation<a class="anchor" aria-label="anchor" href="#operation"></a>
</h3>
<p>The harmonized variable is generated by applying an operation to one
or more study-specific variables.</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-1b01e82c8c54c5ea2ef8" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-1b01e82c8c54c5ea2ef8">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_E <\/code>","<code> DATASET <\/code>","<code> var_x <\/code>","<code> <b>operation<\/b> <\/code>","<code> var_x - mean(var_x) / stats::sd(var_x) <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li><p>Multiple variables can be used to combine their values using
case_when. Separate each of them in <strong>ss_variables</strong> by a
semi-colon <strong>;</strong></p></li>
<li><p>If the operation (or seems) is simple, prefer
<strong>case_when</strong>, <strong>recode</strong> or
<strong>direct_mapping</strong> instead.</p></li>
<li><p>The user must have the libraries present on their machine (and
loaded) to function with the call of them in the script. To specify the
library calling, use double two-point <strong>::</strong> in the
formula.</p></li>
</ul>
<div style="margin-left:10%;">
<pre><code><span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/year.html" class="external-link">year</a></span><span class="op">(</span><span class="va">var_x</span><span class="op">)</span></span></code></pre>
</div>
<ul>
<li>If the operation is requires more complex codification, use
<strong>other</strong> instead.</li>
</ul>
</div>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="other">other<a class="anchor" aria-label="anchor" href="#other"></a>
</h3>
<p>The harmonized variable is generated from a non-standard or complex
processing rule, not covered by other rule categories.</p>
<div style="display: flex;">
<div style="flex: 1;">
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-8a2c118fa7345b42bb26" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-8a2c118fa7345b42bb26">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<b>dataschema_variable<\/b>","<b>ss_table<\/b>","<b>ss_variables<\/b>","<b>Mlstr::rule_category<\/b>","<b>Mlstr::algorithm<\/b>"],["<code> variable_F <\/code>","<code> DATASET <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>other<\/b> <\/code>","<code> # place R code here... <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"ordering":false,"columnDefs":[{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div style="flex: 1;">
<ul>
<li>This feature is equivalent to launch a local code/function in a R
script.</li>
</ul>
</div>
</div>
<div>
<p>If assignment is needed to modify environment of the user, use double
assignation <strong>&lt;&lt;-</strong> to place the result in the user
environment. Carefully make sure you control your environment when using
the <strong>other</strong> function.</p>
<pre><code><span><span class="va">my_harmo_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">+</span> <span class="va">...</span> <span class="co"># complex lines of code</span></span>
<span></span>
<span><span class="co"># double assignation to modify the environment.</span></span>
<span><span class="va">harmonized_dossier</span><span class="op">$</span><span class="va">DATASET</span><span class="op">$</span><span class="va">variable_F</span> <span class="op">&lt;&lt;-</span> <span class="va">my_harmo_var</span></span></code></pre>
<p><strong>other</strong> function can be used to source a code from a
different script where complex harmonization processes are written.</p>
<pre><code><span><span class="kw"><a href="https://rdrr.io/r/base/source.html" class="external-link">source</a></span><span class="op">(</span><span class="st">"my_file.R"</span><span class="op">)</span></span></code></pre>
</div>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="impundebla">impossible, undertermined and __BLANK__<a class="anchor" aria-label="anchor" href="#impundebla"></a>
</h3>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-66b505842e1b78360974" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-66b505842e1b78360974">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<code> variable_D <\/code>","<code> variable_F <\/code>","<code> variable_G <\/code>","<code> variable_H <\/code>"],["<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>","<code> DATASET <\/code>"],["<code> <b>__BLANK__<\/b> <\/code>","<code> <b>__BLANK__<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> <b>paste<\/b> <\/code>","<code> <b>other<\/b> <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"],["<code> Hello word <\/code>","<code> # place R code here... <\/code>","<code> <b>impossible<\/b> <\/code>","<code> <b>undetermined<\/b> <\/code>"]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th><b>dataschema_variable<\/b><\/th>\n      <th><b>ss_table<\/b><\/th>\n      <th><b>ss_variables<\/b><\/th>\n      <th><b>Mlstr::rule_category<\/b><\/th>\n      <th><b>Mlstr::algorithm<\/b><\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"ordering":false,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<p>These additional features allow the user to handle specific cases.
This ensure that the line is completed and there is no missing argument
in the function to perform.</p>
<ul>
<li><p>*__BLANK__* : If no variable is needed to generate the harmonized
variable (for example using the rule category <strong>paste</strong> or
<strong>other</strong>)</p></li>
<li><p><em>impossible</em> : If the study does not collect DataSchema
variable or cannot be used to generate DataSchema variable or is
unknown.</p></li>
<li><p><em>undetermined</em> : If the user needs further investigation
to harmonize, or future information to be completed, they can use this
feature without being blocked in the process.</p></li>
</ul>
<p><a href="#summary">return to summary</a></p>
</div>
<div class="section level3">
<h3 id="status">Mlstr_harmo::status and Mlstr_harmo::status_detail<a class="anchor" aria-label="anchor" href="#status"></a>
</h3>
<p>The harmonization status is a column for documentation which refers
to the status of harmonization. It gives additional information about
the completeness of the generated variable. Another column
<strong>Mlstr_harmo::status_details</strong> gives further
information.</p>
<div>
<p></p>
<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9282aa60c5bc70d9e845" style="width:100%;height:auto;"></div> <script type="application/json" data-for="htmlwidget-9282aa60c5bc70d9e845">{"x":{"filter":"none","vertical":false,"autoHideNavigation":true,"data":[["<code><b>complete<\/b><\/code>","<code><b>partial*<\/b><\/code>","<code><b>impossible<\/b><\/code>","<code><b>undetermined<\/b><\/code>","<code><b>na<\/b><\/code>","<code><b>error<\/b><\/code>"],["Study-specific variable :\n     <ul>\n           <li>is the same<\/li>\n           <li>Needs transformation<\/li> \n           <li>unknown<\/li>\n     <\/ul>","With loss of information, study-specific variable :\n     <ul>\n           <li>approximates results<\/li>\n           <li>needs confirmation<\/li> \n           <li>unknown<\/li>\n     <\/ul>","The dataSchema variable :\n     <ul>\n           <li>is not collected<\/li>\n           <li>cannot be used<\/li> \n           <li>unknown<\/li>\n     <\/ul>","Harmonization status not determined.","Harmonization status is not relevant.","When error, the error message provided <brr>\n                                           by R is stored here"],["<br>\n     <ul>\n           <li><code>identical<\/code><\/li>\n           <li><code>compatible<\/code><\/li>\n           <li><code>unknown<\/code><\/li>\n     <\/ul>","<br>\n     <ul>\n           <li><code>proximate<\/code><\/li>\n           <li><code>tentative<\/code><\/li>\n           <li><code>unknown<\/code><\/li>\n     <\/ul>","<br>\n     <ul>\n           <li><code>unavailable<\/code><\/li>\n           <li><code>incompatible<\/code><\/li>\n           <li><code>unknown<\/code><\/li>\n     <\/ul>","","",""]],"container":"<table class=\"cell-border stripe\">\n  <thead>\n    <tr>\n      <th>Mlstr::status<\/th>\n      <th>definition<\/th>\n      <th>Mlstr::status_detail<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"ordering":false,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<blockquote>
<ul>
<li>Status detail ‘partial’ should be only employed for prospective
harmonization purposes. Prefer Mlstr_harmo::status ‘complete’ /
Mlstr_harmo::status_details ‘compatible’ instead.</li>
</ul>
</blockquote>
<p><a href="#summary">return to summary</a></p>
</div>
</div>
<div class="section level2">
<h2 id="how-to-fill-the-data-processing-element">How to fill the data processing element ?<a class="anchor" aria-label="anchor" href="#how-to-fill-the-data-processing-element"></a>
</h2>
<ol style="list-style-type: decimal">
<li>Open the data processing element template, or an empty one.</li>
</ol>
<p><strong>For each variable to harmonize:</strong></p>
<ol start="2" style="list-style-type: decimal">
<li>Enter DataSchema information:
<ul>
<li>Name of the variable to harmonize</li>
</ul>
</li>
<li>Enter the study specific information :
<ul>
<li>Name of the dataset</li>
<li>Name of the variable(s)</li>
</ul>
</li>
<li>Enter the data processing information
<ul>
<li>Rule category</li>
<li>Algorithm</li>
<li>Harmonization status (not mandatory)</li>
</ul>
</li>
</ol>
<div class="section level3">
<h3 id="example-1-initialization-of-the-harmonization-with-the-dataschema-variable-adm_unique_id-mandatory">Example 1 : initialization of the harmonization with the dataSchema
variable adm_unique_id (mandatory)<a class="anchor" aria-label="anchor" href="#example-1-initialization-of-the-harmonization-with-the-dataschema-variable-adm_unique_id-mandatory"></a>
</h3>
<p><strong>1 Open the dataSchema to understand the variable to
generate.</strong></p>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/adm_unique_id_variable.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><strong>The definition of the variable is in the
dataSchema</strong>. <em>The name and the valueType of the variable will
be reported in the data processing elements.</em></p>
</div>
</div>
<p><br></p>
<p><strong>2 Collect in each dataset the column corresponding to the
participant identifier.</strong></p>
<div class="flex-container">
<div class="image-container-even">
<p>
<strong>id</strong> in dataset_MELBOURNE_1
</p>
<p><img src="../reference/figures/melbourne_1_id.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="image-container-even">
<p>
<strong>id</strong> in dataset_MELBOURNE_2
</p>
<p><img src="../reference/figures/melbourne_2_id.png" style="max-width: 100%; height: auto;"></p>
</div>
</div>
<div class="flex-container">
<div class="image-container-even">
<p>
<strong>ID</strong> in dataset_PARIS
</p>
<p><img src="../reference/figures/paris_id.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="image-container-even">
<p>
<strong>part_id</strong> in dataset_TOKYO
</p>
<p><img src="../reference/figures/tokyo_part_id.png" style="max-width: 100%; height: auto;"></p>
</div>
</div>
<p><br></p>
<p><strong>3 Open the data processing elements and fill for each dataset
the information accordingly</strong></p>
<div>
<p><img style="max-width: 100%; height: auto;" src="../reference/figures/id_creation.png"></p>
<p>
<em>The names in ‘ss_table’ must be the same in the dossier and in the
data processing elements</em>
</p>
</div>
<p><br></p>
</div>
<div class="section level3">
<h3 id="example-2-harmonization-of-the-dataschema-variable-sdc_gender">Example 2 : harmonization of the dataSchema variable sdc_gender<a class="anchor" aria-label="anchor" href="#example-2-harmonization-of-the-dataschema-variable-sdc_gender"></a>
</h3>
<p><strong>1 Open the dataSchema to understand the variable to
generate.</strong></p>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/sdc_gender_var.png" style="max-width: 100%; height: auto;"></p>
<p><br></p>
<p><img src="../reference/figures/sdc_gender_cat.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><br><br><strong>The definition of the variable is in the
dataSchema.</strong> The name and the valueType of the variable will be
reported in the data processing elements. When categorical, Each study
specific variable (when possible) will be recoded to match the
dataSchema variables categories, using rules of harmonization.</p>
<p><em>For each dataset, use the data dictionary to comprehend
codification and start elaborating the script of harmonization.</em></p>
</div>
</div>
<p><br></p>
<p><strong>2 Identidy for each dataset which column (variable) will be
associated to the harmonization script to generate the harmonzed
variable.</strong></p>
<div class="section level4">
<h4 id="dataset_melbourne_1">dataset_MELBOURNE_1<a class="anchor" aria-label="anchor" href="#dataset_melbourne_1"></a>
</h4>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/melbourne_1_gender.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><br> For dataset_MELBOURNE_1, the corresponding variable ‘Gender’
share the same codification with the dataSchema variable. The script is
a <strong>direct_mapping</strong>.</p>
</div>
</div>
<div>
<p>
<strong><em>Start filling the data processing element for each of the
studies, one dataSchema variable after the other.</em></strong>
</p>
<p><img style="max-width: 100%; height: auto;" src="../reference/figures/melbourne_1_dpe.png"></p>
</div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="dataset_melbourne_2">dataset_MELBOURNE_2<a class="anchor" aria-label="anchor" href="#dataset_melbourne_2"></a>
</h4>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/melbourne_2_gender_not_collected.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><br> For dataset_MELBOURNE_2, There is no corresponding variable
collected. The harmonization is <strong>impossible</strong>.</p>
</div>
</div>
<div>
<p><img style="max-width: 100%; height: auto;" src="../reference/figures/melbourne_2_dpe.png"></p>
</div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="dataset_paris">dataset_PARIS<a class="anchor" aria-label="anchor" href="#dataset_paris"></a>
</h4>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/paris_sex.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><br> For dataset_PARIS, the corresponding variable ‘SEX’ has a
codification which is compatible with the dataSchema variable
codification. The script is a <strong>recode</strong>, where each ‘0’
will be recoded into ‘1’ and each ‘1’ into ‘2’.</p>
</div>
</div>
<div>
<p><img style="max-width: 100%; height: auto;" src="../reference/figures/paris_dpe.png"></p>
</div>
<p><br></p>
</div>
<div class="section level4">
<h4 id="dataset_tokyo">dataset_TOKYO<a class="anchor" aria-label="anchor" href="#dataset_tokyo"></a>
</h4>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/tokyo_gndr.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><br> For dataset_TOKYO, the corresponding variable ‘gndr’, the
script is also a <strong>recode</strong>, where each ‘Male’ will be
recoded into ‘1’ and each ‘Female’ into ‘2’.</p>
</div>
</div>
<div>
<p><img style="max-width: 100%; height: auto;" src="../reference/figures/tokyo_dpe.png"></p>
</div>
<p><br><br><br></p>
<p><strong>3 Fill the data processing elements.</strong></p>
<p>Process similarily for each dataSchema variable. When further
investigation or future information to be completed, put
<b>undetermined</b> as a placeholder.</p>
<div>
<p><img style="max-width: 100%; height: auto;" src="../reference/figures/dpe_all.png"></p>
</div>
<p><br></p>
<p>Save your work, close file and upload it in your R environment if
necessary.</p>
<p><strong>Warning ⚠</strong> In your environnement, additional objects
must exist: * The dossier containing your study specific dataset(s) *
The dataSchema. If not, a minimum DataSchema will be created from
elements found in the Data Processing Elements.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">dataset_MELBOURNE_1</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">dataset_MELBOURNE_1</span></span>
<span><span class="va">dataset_MELBOURNE_2</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">dataset_MELBOURNE_2</span></span>
<span><span class="va">dataset_PARIS</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">dataset_PARIS</span></span>
<span><span class="va">dataset_TOKYO</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">dataset_TOKYO</span></span>
<span></span>
<span><span class="co"># create the dossier</span></span>
<span><span class="va">dossier</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/madshapR/man/dossier_create.html" class="external-link">dossier_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">dataset_MELBOURNE_1</span>, <span class="va">dataset_MELBOURNE_2</span>, <span class="va">dataset_PARIS</span>, <span class="va">dataset_TOKYO</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dataschema</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">`dataschema - final`</span></span>
<span><span class="va">data_proc_elem</span> <span class="op">&lt;-</span> <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">`data_processing_elements - final`</span></span>
<span></span>
<span><span class="co"># perform harmonization</span></span>
<span><span class="fu"><a href="../reference/harmo_process.html">harmo_process</a></span><span class="op">(</span><span class="va">dossier</span>,<span class="va">dataschema</span>,<span class="va">data_proc_elem</span><span class="op">)</span></span>
<span>    </span></code></pre></div>
<p><a href="d-Example-with-DEMO-files.html">See the whole process of
harmonization through a DEMO</a></p>
</div>
</div>
<div class="section level3">
<h3 id="understanding-the-output-how-to-detect-and-correct-errors-">Understanding the output : how to detect and correct errors.<a class="anchor" aria-label="anchor" href="#understanding-the-output-how-to-detect-and-correct-errors-"></a>
</h3>
<p>If the process of harmonization produces errors in R, the process
will not generate the harmonized datasets affected, to avoid version
conflicts. The error will be stored in a the column
‘Mlstr_harmo::status’ in its study specific dataschema. The error can be
read directly in the console using the function <a href="../reference/show_harmo_error.html">show_harmo_error()</a></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">data_proc_elem</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">DEMO_files_harmo</span><span class="op">$</span><span class="va">`data_processing_elements - with error`</span></span>
<span></span>
<span><span class="co"># perform harmonization</span></span>
<span><span class="va">harmonized_dossier</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/harmo_process.html">harmo_process</a></span><span class="op">(</span><span class="va">dossier</span>, <span class="va">dataschema</span>, <span class="va">data_proc_elem</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the function to help correcting elements of the harmonization;</span></span>
<span><span class="fu"><a href="../reference/show_harmo_error.html">show_harmo_error</a></span><span class="op">(</span><span class="va">harmonized_dossier</span><span class="op">)</span></span>
<span>    </span></code></pre></div>
<div class="flex-container">
<div class="image-container-big">
<p><img src="../reference/figures/melbourne_2_error.png" style="max-width: 100%; height: auto;"></p>
</div>
<div class="text-container-small">
<p><br><strong><em>Example</em></strong> <em>: in the data processing
element, a semi-colon is missing in the script. The error generated can
be visually assessed in the console so the user can make
corrections.</em></p>
</div>
</div>
<p><strong>Warning ⚠</strong> Sometimes, the harmonization produces
warnings which are to consider and analyse very closely, because they
may refer to errors. A common warning generated is when a decimal is
converted into an integer. R does not analyses it as an error, but the
information is wrongly harmonized in that case. You should always use <a href="../reference/harmonized_dossier_evaluate.html">harmonized_dossier_evaluate()</a>,
<a href="../reference/harmonized_dossier_summary.html">harmonized_dossier_summary()</a>
and <a href="../reference/harmonized_dossier_visualize.html">harmonized_dossier_visualize()</a>
to help in the the assessment of harmonization.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Guillaume Fabre, Maelstrom-research group.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
